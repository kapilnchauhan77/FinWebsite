<script>


    $( document ).ready(function(){
        Chart.defaults.global.defaultFontColor = '#858796';

        function add_doughnutCharts(currentVal_array){
            var ctx = document.getElementById("invested_val_allocation_SA");
            if (ctx){
                invested_value_allocation(ctx, currentVal_array);
                /* stocksAreaChart(); */
                sectorAllocations();
            };
        };

        // Bar Chart Example
        var ctx = document.getElementById("myBarChart");
        var myBarChart = new Chart(ctx, {
            type: 'horizontalBar',
            data: {
              labels: ["LTCG", "STCG"],
              datasets: [{
                  barThickness: 22,
                  data: [-238, -553],
                  backgroundColor: "#838383",
              },{
                  barThickness: 22,
                  data: [727, 589],
                  backgroundColor: "#1471cd",
              }],
            },
            options: {
                hover: {
                    animationDuration: 1,
                    mode: false
                },
                maintainAspectRatio: false,
                scales: {
                    xAxes: [{
                        time: {
                            unit: 'month'
                        },
                        gridLines: {
                            display: false,
                            drawBorder: false
                        },
                        ticks: {
                            maxTicksLimit: 6
                        },
                        maxBarThickness: 25,
                        stacked: true,
                    }],
                    yAxes: [{
                        ticks: {
                            min: -1500,
                            max: 4500,
                            maxTicksLimit: 5,
                            padding: 10,
                        },
                        gridLines: {
                            color: "rgb(234, 236, 244)",
                            zeroLineColor: "rgb(234, 236, 244)",
                            drawBorder: false,
                            borderDash: [2],
                            zeroLineBorderDash: [2]
                        },
                        stacked: true,
                    }],
                },
                legend: {
                    display: false
                },
                tooltips: {
                    titleMarginBottom: 2,
                    titleFontSize: 14,
                    borderColor: '#dddfeb',
                    borderWidth: 1,
                    xPadding: 20,
                    displayColors: false,
                    intersect: false,
                    mode: 'index',
                    caretPadding: 10,
                    callbacks: {
                        label: function(tooltipItem, chart) {
                            console.log(tooltipItem);
                            var datasetLabel = (tooltipItem.datasetIndex === 0) ? 'Unrealised' : 'Realised';
                            return datasetLabel + ': $' + (tooltipItem.xLabel);
                        }
                    }
                },
                animation: {
                    duration: 0,
                    onComplete: function () {
                        var chartInstance = this.chart,
                        ctx = chartInstance.ctx;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        this.data.datasets.forEach(function (dataset, i) {
                            var meta = chartInstance.controller.getDatasetMeta(i);
                            meta.data.forEach(function (bar, index) {
                                var data = dataset.data[index];
                                ctx.fillText(data, bar._model.x, bar._model.y - 12);
                            });
                        });
                    }
                }

            }
        });

        // Overall P&L Distribution
        var ctx = document.getElementById("Overall_PL");
        if (ctx){
            var myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                        datasets: [{
                        data: [47, 33, 20],
                        backgroundColor: ['#1cc88a', '#e32d2d', '#787f8a'],
                        hoverBackgroundColor: ['#17a673', '#b81d1d', '#656970'],
                        hoverBorderColor: "rgba(234, 236, 244, 1)",
                    }],
                },
                options: {
                    maintainAspectRatio: false,
                    tooltips: {
                        backgroundColor: "rgb(255,255,255)",
                        bodyFontColor: "#858796",
                        borderColor: '#dddfeb',
                        borderWidth: 1,
                        xPadding: 15,
                        yPadding: 15,
                        displayColors: false,
                        caretPadding: 10,
                        callbacks: {
                            label: function(tooltipItem, data) {
                                var _labels = ["Profitable Stocks", "Loss-making Stocks", "Neutral Stocks"];
                                var dataset = data.datasets[tooltipItem.datasetIndex];
                                var currentValue = dataset.data[tooltipItem.index];
                                var _label = _labels[tooltipItem.index];

                                return _label + ": " + currentValue + "%";
                            }
                        },
                    },
                    legend: {
                        display: false
                    },
                    cutoutPercentage: 60,
                },
            });

            // Todays P&L Distribution
            var ctx = document.getElementById("Days_PL");
            var myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                        datasets: [{
                        data: [52, 36, 12],
                        backgroundColor: ['#1cc88a', '#e32d2d', '#787f8a'],
                        hoverBackgroundColor: ['#17a673', '#b81d1d', '#656970'],
                        hoverBorderColor: "rgba(234, 236, 244, 1)",
                    }],
                },
                options: {
                    maintainAspectRatio: false,
                    tooltips: {
                        backgroundColor: "rgb(255,255,255)",
                        bodyFontColor: "#858796",
                        borderColor: '#dddfeb',
                        borderWidth: 1,
                        xPadding: 15,
                        yPadding: 15,
                        displayColors: false,
                        caretPadding: 10,
                        callbacks: {
                            label: function(tooltipItem, data) {
                                var _labels = ["Profitable Stocks", "Loss-making Stocks", "Neutral Stocks"];
                                var dataset = data.datasets[tooltipItem.datasetIndex];
                                var currentValue = dataset.data[tooltipItem.index];
                                var _label = _labels[tooltipItem.index];

                                return _label + ": " + currentValue + "%";
                            }
                        },
                    },
                    legend: {
                        display: false
                    },
                    cutoutPercentage: 60,
                },
            });

        }
    });

</script>
